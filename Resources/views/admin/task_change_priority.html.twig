{% extends '@EasyAdmin/page/content.html.twig' %}

{% block content_title %}
    调整优先级 - {{ task.description }}
{% endblock %}

{% block main %}
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">任务信息</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>任务ID:</strong> {{ task.id }}</p>
                            <p><strong>任务类型:</strong> {{ task.type.value }}</p>
                            <p><strong>任务状态:</strong>
                                <span class="badge badge-{{ task.status.value == 'pending' ? 'secondary' : task.status.value == 'in_progress' ? 'primary' : 'info' }}">
                                    {{ task.status.value }}
                                </span>
                            </p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>当前优先级:</strong>
                                <span class="badge badge-warning">{{ task.priority }}</span>
                            </p>
                            <p><strong>作业位置:</strong> {{ task.location }}</p>
                            <p><strong>分配作业员:</strong>
                                {% if task.assignedWorker %}
                                    作业员 #{{ task.assignedWorker }}
                                {% else %}
                                    <span class="text-muted">未分配</span>
                                {% endif %}
                            </p>
                        </div>
                    </div>
                    {% if task.description %}
                        <div class="mt-3">
                            <p><strong>任务描述:</strong></p>
                            <p class="text-muted">{{ task.description }}</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">调整优先级</h5>
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        <strong>优先级说明:</strong>
                        <ul class="mb-0 mt-2">
                            <li>优先级范围: 1-100</li>
                            <li>数值越高，优先级越高</li>
                            <li>大幅调整（超过20个点）将触发智能重排序</li>
                        </ul>
                    </div>

                    {{ form_start(form) }}
                    <div class="row">
                        <div class="col-md-4">
                            {{ form_row(form.priority) }}
                        </div>
                        <div class="col-md-6">
                            {{ form_row(form.reason) }}
                        </div>
                        <div class="col-md-2">
                            <div class="form-group mt-4">
                                {{ form_widget(form.update) }}
                                <a href="{{ path('admin') }}" class="btn btn-secondary ml-2">取消</a>
                            </div>
                        </div>
                    </div>
                    {{ form_end(form) }}
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h6 class="card-title mb-0">优先级参考标准</h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="text-center">
                                <span class="badge badge-danger p-2" style="font-size: 14px;">90-100</span>
                                <p class="mt-2 mb-0"><strong>紧急任务</strong></p>
                                <small class="text-muted">需要立即处理</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center">
                                <span class="badge badge-warning p-2" style="font-size: 14px;">70-89</span>
                                <p class="mt-2 mb-0"><strong>高优先级</strong></p>
                                <small class="text-muted">需要优先处理</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center">
                                <span class="badge badge-info p-2" style="font-size: 14px;">40-69</span>
                                <p class="mt-2 mb-0"><strong>普通优先级</strong></p>
                                <small class="text-muted">正常处理顺序</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center">
                                <span class="badge badge-secondary p-2" style="font-size: 14px;">1-39</span>
                                <p class="mt-2 mb-0"><strong>低优先级</strong></p>
                                <small class="text-muted">可延后处理</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}